---
tags:
 - Kail
 - 信息收集
---
# 目标资产主动信息收集原理

## 1.1 主动信息收集的原理

### 1.1.1 主动信息收集的特点

1.  直接与目标系统进行交互
2.  无法避免留法访问痕迹
3.  使用受控的第三方电脑进行监测，使用代理或已经被控制的机器。
4.  扫描发送不同的探测，根据返回结果判断目标状态

## 1.2 二层发现 -arping/netdiscover 命令

### 1.2.1 二层主机发现

1.  利用OSI中的链路层中的协议进行发现，一般使用ARP协议。
2.  二层发现的优缺点：\
    优点：扫描速度快、可靠性高。\
    缺点：不可路由。

### 1.2.2 arping 命令使用

1.  ARP协议概述：
    ARP协议是“Address Resolution Protocol（地址解析协议）”的缩写，计算机通过ARP协议将IP地址转换成MAC地址。

### 1.2.3 netdiscover

netdiscover是一个主动/被动的 ARP 侦察工具，使用netdiscover工具可以在网络上扫描IP地址，检查在线主机或搜索为他们发送的ARP请求。

#### 主动模式：

    netdiscover -i eth0 -r 192.168.1.0/24
    //-i 是指定网卡
    //-r 是指定ip地址范围

主动发现网络内主机（向网段内所有的主机发送一个arp包），但是这种方式容易被发现，往往会引起网络管理员的注意。

#### 被动模式：

    netdiscover -p

被动模式的方式更加隐蔽，但是速度会比较慢，网卡被设置为混杂模式来监听网络内的arp数据包进行被动模式，这种方式就需要网络设备发送arp包才能被探测到。

## 1.3 三层发现 -ping命令工具探索

### 1.3.1 三层主机发现

三层主机发现：利用OSI中网络中的协议进行主机发现，一般使用IP、ICMP协议。

#### 三层扫描的优缺点：

优点：可以经过路由的主机，速度相对较快。

缺点：速度比二层发现慢，经常会被防火墙过滤。

### 1.3.2 路由追踪 -traceruote

    traceruote 目标主机

### 1.3.3 HPING3

hping3是一个命令行下使用TCP/IP数据包组装/分析工具，通常web服务器会用来做压力测试使用，也可以进行DOS攻击的实验，同样hping只能每次扫描一个目标。

    hping3 -c 1000 -d 120 -S -w 64 -p 80 --flood --rand-source ke.qq.com

\-c 1000: 发送的数据包数量\
\-d 120: 发送到目标机器的每个数据包的大小，单位是字节\
\-S: 只发送SYN数据包\
\-w 64: TCP窗口大小\
\-p 80: 目的地址的端口。\
\--flood: 尽可能快地发送数据包，不需要考虑显示入站回复，洪水攻击模式。\
\--rand-source: 使用随机性的源头IP地址，这里的伪造IP地址，只是在局域网中伪造，通过路由器还是会还原成真实的IP地址。

### 1.3.4 FPING 工具

fping就是ping命令的加强版，他可以对一个IP段进行ping扫描，而ping命令本身是不可以对网段进行扫描的。

    fping -g 192.168.1.0/24 -c 1 > fping.txt

\-g: 表示对地址段进行扫描，如果不加可以对某个IP进行扫描\
\-c: 表示ping的次数\
fping.txt 表示将扫描结果重定向到fping.txt，原因是如果扫描一个网段的话输出是非常多的，我们输出重定向到文件中，只会获得存活的主机信息。

## 1.4 四层发现 -Nmap的扫描方式

nmap是一个网络探测和安全扫描工具，系统管理者和个人都可以使用这个软件扫描大型的网络，获取那台主机正在运行以及提供扫描服务等信息。

nmap支持很多扫描技术，例如：UDP、TCP、connect()、TCP SYN(半开扫描)、ftp代理(bounce攻击)、反向标志、ICMP、FIN、ACK扫描、圣诞树(Xmas Tree)、SYN扫描和null扫描。

还可以探测操作系统类型。

1.  \-O: 显示目标服务器系统类型
2.  \-p: 扫描一个端口范围：-p 1-200

## 1.5 scapy定制数据吧

Scapy是一个Python程序，它允许用户发送、嗅探、分析和伪造网络包。
这种能力允许构建能够探测、扫描或攻击网络的工具。换句话说，Scapy是一个强大的交互式包操作程序。
